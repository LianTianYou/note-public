---
title: 2. 内存分配
---

# 2. 内存分配

# 内存模型

**C++ 内存分区模型：**代码区、全局区、栈区、堆区。
**代码区：**

- 存储 CPU 执行的机器指令（二进制代码），由操作系统管理。
- 存储在可执行文件中，运行后加载到内存。
- 代码区是共享的，对于频繁被执行的程序，只需要在内存中有一份代码即可。
- 代码区是只读的，防止指令被意外修改。

**全局区：**

- 存放全局变量、静态变量和字符串常量。
- 程序结束后，由操作系统释放。

**栈区：**

- 由编译器自动释放，存储函数中的参数值、局部变量等。
- 注意：不要返回局部变量的地址，栈区开辟的数据由编译器自动释放。

**堆区：**

- 由程序员分配和释放，如果没释放，则在程序结束后，由操作系统回收。
- C++ 主要利用 new 在堆区开辟内存。

# new 关键字

在堆区开辟内存：

```cpp
new 数据类型(值);		// 返回该内存的指针
```

释放内存：

```cpp
delete 变量;			// 释放变量存储的地址
```

使用 new 创建数组：

```cpp
new 数据类型[长度];		// 申请一片连续空间，返回首地址
```

创建数组并初始化：

```cpp
new 数据类型[长度]{元素1, 元素2, ...};
```

释放数组：

```cpp
delete[] 变量;
```
